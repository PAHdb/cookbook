<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Working with geometry data &mdash; PAHdb cookbook  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=a5c4661c" />

  
    <link rel="shortcut icon" href="_static/touch-icon-310x310.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/tabs.js?v=3030b3cb"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Working with laboratory data" href="sec_01-working_with_lab.html" />
    <link rel="prev" title="Accessing data" href="sec_01-accessing_data.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            PAHdb cookbook
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="sec_01.html">API Overview</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sec_01-getting_started.html">Getting started</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-accessing_data.html">Accessing data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Working with geometry data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-working_with_lab.html">Working with laboratory data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-working_with_transitions.html">Working with transition data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-using_emission_models.html">Using emission models</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-creating_spectra.html">Creating spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-working_with_spectra.html">Working with spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-working_with_obs.html">Working with observational data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-spectroscopic_fitting.html">Spectroscopic fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-working_with_fitted_data.html">Working with fitted data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_01-working_outside_the_classes.html">Working outside the classes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sec_02.html">Recipes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sec_02-fit_a_spectrum.html">Fit a spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="sec_02-stellar_kurucz_model.html">Stellar Kurucz Model</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PAHdb cookbook</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="sec_01.html">API Overview</a></li>
      <li class="breadcrumb-item active">Working with geometry data</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="sec_01-accessing_data.html" class="btn btn-neutral float-left" title="Accessing data" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sec_01-working_with_lab.html" class="btn btn-neutral float-right" title="Working with laboratory data" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="working-with-geometry-data">
<h1>Working with geometry data<a class="headerlink" href="#working-with-geometry-data" title="Link to this heading">¶</a></h1>
<p>Molecular geometry data is exposed through an ‘geometry’-instance.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-SURM" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-SURM" name="SURM" role="tab" tabindex="0">IDL</button><button aria-controls="panel-0-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-0-SURM" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-SURM" name="SURM" role="tabpanel" tabindex="0"><div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>uids<span class="w"> </span><span class="o">=</span><span class="w"> </span>pahdb<span class="o">-&gt;</span>Search(<span class="s2">&quot;c&lt;=20 neutral n=2 neutral&quot;</span>)

geometry<span class="w"> </span><span class="o">=</span><span class="w"> </span>pahdb<span class="o">-&gt;</span>getGeometryByUID(uids)
</pre></div>
</div>
</div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">uids</span> <span class="o">=</span> <span class="n">pahdb</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;c&lt;=20 neutral n=2 neutral&quot;</span><span class="p">)</span>

<span class="n">geometry</span> <span class="o">=</span> <span class="n">pahdb</span><span class="o">.</span><span class="n">getgeometrybyuid</span><span class="p">(</span><span class="n">uids</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>The ‘geometry’-instance provides both the ‘Plot’ and
‘Structure’-methods to output the chemical structure of the PAH with
provided UID. The first method uses a 2D representation, while the
latter a 3D one.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-SURM" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-SURM" name="SURM" role="tab" tabindex="0">IDL</button><button aria-controls="panel-1-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-1-SURM" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-SURM" name="SURM" role="tabpanel" tabindex="0"><div class="highlight-idl notranslate"><div class="highlight"><pre><span></span><span class="c1">;; UID 18 = coronene (C24H12)</span>

void<span class="w"> </span><span class="o">=</span><span class="w"> </span>geometry<span class="o">-&gt;</span><span class="nb">Plot</span>(<span class="mi">18</span>)

img<span class="w"> </span><span class="o">=</span><span class="w"> </span>geometry<span class="o">-&gt;</span>Structure(<span class="mi">18</span>)
</pre></div>
</div>
</div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># UID 18 = coronene (C24H12)</span>

<span class="n">geometry</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>The ‘Plot’-method will accept the ‘Scale’, ‘Thick’, and ‘RGB’- keywords
to control the scale at which the atoms are to be drawn, the thickness
of the bonds, and if colors should be outputted as decomposed RGB,
respectively. In addition, the ‘NoErase’ and ‘Position’-keywords
control display erasing prior plotting and the plot position in
normalized coordinates, respectively. When the ‘Resolution’-keyword
is set, the plot will be rendered to a Z-buffer device at given
resolution and outputted as an image and returned to the caller.
When the ‘Save’-keyword is also set, a PNG-image will be generated
as well, which will have the UID of the PAH molecule under
consideration embedded in the filename. Lastly, the ‘Angle’-keyword
controls rotation of the structure around the z-axis.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-SURM" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-SURM" name="SURM" role="tab" tabindex="0">IDL</button><button aria-controls="panel-2-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-2-SURM" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-SURM" name="SURM" role="tabpanel" tabindex="0"><div class="highlight-idl notranslate"><div class="highlight"><pre><span></span><span class="c1">;; UID 18 = coronene (C24H12)</span>

img<span class="w"> </span><span class="o">=</span><span class="w"> </span>geometry<span class="o">-&gt;</span><span class="nb">Plot</span>(<span class="mi">18</span>,<span class="w"> </span>Scale<span class="o">=</span><span class="mf">2.0</span>,<span class="w"> </span>Thick<span class="o">=</span><span class="mf">5.0</span>,<span class="w"> </span>$
<span class="w">                 </span>Resolution<span class="o">=</span>[<span class="mi">1200</span>,<span class="w"> </span><span class="mi">1200</span>],<span class="w"> </span><span class="o">/</span><span class="nb">Save</span>)
</pre></div>
</div>
</div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># UID 18 = coronene (C24H12)</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">thick</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> \
                 <span class="n">resolution</span><span class="o">=</span><span class="p">(</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1200</span><span class="p">),</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>The ‘Structure’-method will accept the ‘Background’ and
‘Frame’-keywords to control background color and display of a
wireframe. The ‘Resolution’-keyword controls the dimension of the
3D-rendered output image. The ‘Save’-keyword can be specified to save
the generated image as a PNG-image as well, which will have the UID of
the PAH molecule under consideration embedded in the filename. If in
addition the ‘Transparent’-keyword is specified as a color-triplet
array, that color will be set to transparent in the generated
PNG-file. The ‘Axis’ and ‘Angle’-keywords can control axis and angle
of rotation, respectively. With the ‘View’-keyword set the generated
structure will be rendered on screen. Lastly, when the ‘Obj’-keyword
is set, the generated 3D model is returned to the caller.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-SURM" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-SURM" name="SURM" role="tab" tabindex="0">IDL</button><button aria-controls="panel-3-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-3-SURM" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-SURM" name="SURM" role="tabpanel" tabindex="0"><div class="highlight-idl notranslate"><div class="highlight"><pre><span></span><span class="c1">;; UID 18 = coronene (C24H12)</span>

img<span class="w"> </span><span class="o">=</span><span class="w"> </span>geometry<span class="o">-&gt;</span>Structure(<span class="mi">18</span>,<span class="w"> </span>Background<span class="o">=</span>[<span class="mi">0</span>,<span class="w"> </span><span class="mi">255</span>,<span class="w"> </span><span class="mi">0</span>],<span class="w"> </span>$
<span class="w">                              </span>Resolution<span class="o">=</span>[<span class="mi">600</span>,<span class="w"> </span><span class="mi">600</span>],<span class="w"> </span>$
<span class="w">                              </span><span class="o">/</span><span class="nb">Save</span>,<span class="w"> </span>Transparent<span class="o">=</span>[<span class="mi">0</span>,<span class="w"> </span><span class="mi">255</span>,<span class="w"> </span><span class="mi">0</span>],<span class="w"> </span>$
<span class="w">                              </span><span class="o">/</span>View)
</pre></div>
</div>
</div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">img</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> \
                             <span class="n">resolution</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> \
                              <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> \
                              <span class="n">view</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>In addition, the ‘geometry’-instance provides the ‘Mass’, ‘Rings’, and
‘Area’-methods that return the calculated mass based on atomic masses,
the number of 3-8 membered rings, and total surface area of the PAH
molecules under consideration.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-SURM" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-SURM" name="SURM" role="tab" tabindex="0">IDL</button><button aria-controls="panel-4-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-4-SURM" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-SURM" name="SURM" role="tabpanel" tabindex="0"><div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>masses<span class="w"> </span><span class="o">=</span><span class="w"> </span>geometry<span class="o">-&gt;</span>Mass()

rings<span class="w"> </span><span class="o">=</span><span class="w"> </span>geometry<span class="o">-&gt;</span>Rings()

areas<span class="w"> </span><span class="o">=</span><span class="w"> </span>geometry<span class="o">-&gt;</span>Area()
</pre></div>
</div>
</div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">masses</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">mass</span><span class="p">()</span>

<span class="n">rings</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">rings</span><span class="p">()</span>

<span class="n">areas</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">area</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
<p>Lastly, the ‘Inertia’-method provides the moment of inertia matrices,
which are diagonalized with the ‘Diagonalize’-method, for the PAH
molecules under consideration. The latter method can be particular
useful to ensure proper alignment of the structure with the view
before calling the ‘Plot’ or ‘Structure’-methods.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-SURM" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-SURM" name="SURM" role="tab" tabindex="0">IDL</button><button aria-controls="panel-5-UHl0aG9u" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-5-SURM" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-SURM" name="SURM" role="tabpanel" tabindex="0"><div class="highlight-idl notranslate"><div class="highlight"><pre><span></span>matrix<span class="w"> </span><span class="o">=</span><span class="w"> </span>geometry<span class="o">-&gt;</span>Inertia()

geometry<span class="o">-&gt;</span>Diagonalize
</pre></div>
</div>
</div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">matrix</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">inertia</span><span class="p">()</span>

<span class="n">geometry</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">()</span>
</pre></div>
</div>
</div></div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sec_01-accessing_data.html" class="btn btn-neutral float-left" title="Accessing data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sec_01-working_with_lab.html" class="btn btn-neutral float-right" title="Working with laboratory data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Dr. Christiaan Boersma and Dr. Matthew J. Shannon.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>